# Perfil produção (Render). Ative com: spring.profiles.active=production
# DataSource: ProductionDataSourceConfig cria o bean a partir de SPRING_DATASOURCE_* ou DATABASE_URL.

spring:
  main:
    allow-bean-definition-overriding: true

  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration

  datasource:
    hikari:
      minimum-idle: 2
      maximum-pool-size: 10
      idle-timeout: 30000
      max-lifetime: 1800000
      connection-timeout: 30000
      pool-name: PostgreSQLHikariCP

  jpa:
    properties:
      hibernate:
        format_sql: false
        show_sql: false
    show-sql: false

server:
  port: ${PORT:8080}
  servlet:
    context-path: /convivium

app:
  storage:
    type: ${APP_STORAGE_TYPE:local}
    endpoint: ${APP_STORAGE_ENDPOINT:}
    region: ${APP_STORAGE_REGION:us-east-1}
    bucket-name: ${APP_STORAGE_BUCKET_NAME:convivium}
    access-key: ${APP_STORAGE_ACCESS_KEY:}
    secret-key: ${APP_STORAGE_SECRET_KEY:}

  # CORS: defina APP_FRONTEND_URL no Render (ex: https://convivium2.onrender.com) para o front acessar a API.
  cors:
    allowed-origins:
      - ${CORS_ALLOWED_ORIGINS:${APP_FRONTEND_URL:http://localhost:5173}}

  jwt:
    secret: ${JWT_SECRET}

  whatsapp:
    enabled: ${APP_WHATSAPP_ENABLED:false}
    phone-number-id: ${APP_WHATSAPP_PHONE_NUMBER_ID:}
    access-token: ${APP_WHATSAPP_ACCESS_TOKEN:}
    base-url: ${APP_WHATSAPP_BASE_URL:${APP_URL:}}
    template:
      encomenda: ${APP_WHATSAPP_TEMPLATE_ENCOMENDA:encomenda_na_portaria}
